<%= turbo_frame_tag "log_caves_#{@log.id}" do %>
  <%= content_spacing do %>
    <div class="flex justify-between items-center">
      <h2>Caves visited</h2>
      <%= link_to "Done", log_path(log), aria: { label: 'Done editing' }, class: 'btn btn-sm' %>
    </div>
    <div class="flex flex-col gap-2">
      <h3>Currently on log</h3>
      <ul class="grid-list">
        <% current_caves.each do |cc| %>
          <% if cc.cave.present? %>
            <li class="grid-list-item">
              <p><%= cc.cave.title %></p>
              <%= render "caves/attached-cave-form", path: remove_cave_log_path(@log), action: "Remove", cave: cc.cave, data: { "turbo-method": :delete, "turbo-confirm": "Are you sure? Any locations related to this cave will be deleted for this log as well." } %>
            </li>
          <% else %>
            <li class="grid-list-item">
              <p class="text-lg font-medium flex items-center gap-1">
                <span class="h-3 w-3 rounded-full bg-orange-500"></span><%= cc.cave_title %>
              </p>
              <%= render "remove-unconnected-cave-copy-form", path: remove_unconnected_cave_log_path(@log), lcc: cc %>
            </li>
          <% end %>
        <% end %>
      </ul>
    </div>
    <div class="flex flex-col gap-2">
      <h3>Add additional caves</h3>
      <%= render "caves/search-bar", path: edit_caves_log_path(@log) %>
    </div>
    <% if available_caves.length > 0 %>
      <ul class="grid-list">
        <% available_caves.each do |cave| %>
          <li class="grid-list-item">
            <p><%= cave.title %></p>
            <%= render "caves/attached-cave-form", path: add_cave_log_path(@log), action: "Add", cave: cave, data: {} %>
          </li>
        <% end %>
      </ul>
    <% else %>
      <%= render 'components/empty-section', message: 'No caves meeting your criteria' %>
    <% end %>
  <% end %>
<% end %>
